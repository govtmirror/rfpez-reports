// Generated by CoffeeScript 1.3.3
(function() {
  var typeahead_searching;

  typeahead_searching = false;

  $("#add-collaborator-form input[name=username]").typeahead({
    minLength: 3,
    source: function(query, process) {
      clearTimeout(typeahead_searching);
      return typeahead_searching = setTimeout(function() {
        return $.ajax({
          url: "/users/typeahead",
          data: {
            query: query
          },
          success: function(data) {
            return process(data);
          }
        });
      }, 200);
    }
  });

  $(document).on("submit", "#add-collaborator-form", function(e) {
    var button, input;
    e.preventDefault();
    input = $(this).find("input[name=username]");
    button = $(this).find("button");
    button.button('loading');
    return $(this).ajaxSubmit({
      success: function(data) {
        button.button('reset');
        if (data.status === "success") {
          $(".collaborators-table tbody").append("<tr><td>" + (input.val()) + "</td></tr>");
          return input.val('');
        } else if (data.status === "error") {
          return button.flash_button_message("danger", data.message);
        }
      }
    });
  });

}).call(this);
